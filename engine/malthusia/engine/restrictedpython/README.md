Code from https://github.com/zopefoundation/RestrictedPython/tree/189ebb5d26e7b5ac96326eb01620e4a1410df85e, using the license in LICENSE.txt.

The code is slightly modified to support additional operations.